"use strict";var e=require("../../common/vendor.js"),t=require("../../common/constants.js"),o=require("../../utils/request.js"),i=require("../../common/requestFunctions.js"),s=require("../../common/storageFunctions.js");require("../../common/storageKeys.js");const n={data:()=>({title:"用户主页",isRefresh:!1,userInfo:{},myArticles:[],articlesPage:1,haveMoreData:!0,isAttention:0,isMe:!1,editArticleItem:{}}),async onLoad(e){let t=e.userId,o=await i.getUserinfo(t),n=await s.getMyUserInfo();o&&(this.userInfo=o,this.isAttention=o.isAttention,o.id==n.id&&(this.isMe=!0),this.getUserArticles(o.id,this.articlesPage))},onShareAppMessage(){return{title:`${this.userInfo.username}的主页`,path:`/pages/user-home-page/user-home-page?userId=${this.userInfo.id}`,imageUrl:""}},onShareTimeline(){return{title:`${this.userInfo.username}的主页`,path:`/pages/user-home-page/user-home-page?userId=${this.userInfo.id}`,imageUrl:this.userInfo.avatar}},methods:{onNarLeftClick(){e.index.navigateBack({delta:1})},onScrolltolower(){this.haveMoreData&&(this.articlesPage=this.articlesPage+1,this.getUserArticles(this.userInfo.id,this.articlesPage))},onActivityItemClick(t){e.index.navigateTo({url:`/pages/activity-info/activity-info?activityId=${t.id}`})},onMoreClick(t){this.isMe?e.index.showToast({title:"请到我的页面进行操作",icon:"none"}):(this.$refs.articleActionPopup.open(),this.editArticleItem=t)},onPopupReportClick(o){e.index.navigateTo({url:`/pages/setting/report-user/report-user?objectId=${o.id}&objectType=${t.reportObjectType.activity}`}),this.$refs.articleActionPopup.close()},onChatButtonClick(){e.index.navigateTo({url:`/pages/message-secondary-page/chat-content/chat-content?fromUserId=${this.userInfo.id}`})},async onFollowButtonClick(){await i.followUser(this.userInfo.id)&&(this.isAttention=1)},async getUserArticles(i,s){e.index.showLoading({title:"加载中"});let n=await o.request({data:{method:"GET",group:"user",action:`${i}/activity`,data:{userId:i,page:s},header:{"content-type":"application/x-www-form-urlencoded"}}});if(e.index.hideLoading(),n.data.code===t.REQUEST_SUCCEEDED_CODE){let e=n.data.data.pageSum,t=n.data.data.list;if(this.haveMoreData=s<e,1===s)this.myArticles=t;else{let e=this.myArticles.concat(t);this.myArticles=e}t.length<1&&s<e&&(this.articlesPage=s+1,this.getUserArticles(i,this.articlesPage))}}}};if(!Array){(e.resolveComponent("uni-nav-bar")+e.resolveComponent("View")+e.resolveComponent("user-activity-item")+e.resolveComponent("custom-tab-pane")+e.resolveComponent("custom-tabs")+e.resolveComponent("action-sheet-item")+e.resolveComponent("action-sheet"))()}Math||((()=>"../../uni_modules/uni-nav-bar/components/uni-nav-bar/uni-nav-bar.js")+(()=>"../../components/user-activity-item/user-activity-item.js")+(()=>"../../components/custom-tab-pane/custom-tab-pane.js")+(()=>"../../components/custom-tabs/custom-tabs.js")+(()=>"../../components/action-sheet-item/action-sheet-item.js")+(()=>"../../components/action-sheet/action-sheet.js"))();var a=e._export_sfc(n,[["render",function(t,o,i,s,n,a){return e.e({a:e.t(n.title),b:e.o((e=>a.onNarLeftClick())),c:e.p({"left-icon":"back",fixed:"true",border:!1,backgroundColor:"#ffffff00",color:"#808080",statusBar:"true"}),d:e.p({className:"upper-head"}),e:n.userInfo.id},n.userInfo.id?e.e({f:n.userInfo.avatar},n.userInfo.avatar?{g:n.userInfo.avatar}:{},{h:n.userInfo.vip&&n.userInfo.vip.remainDays>0?"../../static/svgs/vip-logo.svg":"../../static/svgs/no-vip-logo.svg",i:e.o((e=>t.onNavigateTo("/pages/setting/personal_information/personal_information"))),j:e.t(n.userInfo.attentionSum),k:e.o(((...e)=>t.onFollowedNumberClick&&t.onFollowedNumberClick(...e))),l:e.t(n.userInfo.beAttentionSum),m:e.o(((...e)=>t.onFansNumberClick&&t.onFansNumberClick(...e))),n:e.t(n.userInfo.visitorSum),o:e.o(((...e)=>t.onVisitorNumberClick&&t.onVisitorNumberClick(...e))),p:0==n.isAttention},0==n.isAttention?{q:e.o((e=>a.onFollowButtonClick()))}:{},{r:e.o((e=>a.onChatButtonClick())),s:e.o((()=>{}))}):{},{t:e.o(((...e)=>t.onBackgroundClick&&t.onBackgroundClick(...e))),v:n.userInfo.background?`url(${n.userInfo.background})`:"linear-gradient(to bottom, #e7d3aa, #61c5ae);",w:e.f(n.myArticles,((t,o,i)=>({a:e.o((e=>a.onActivityItemClick(t))),b:e.o((e=>a.onMoreClick(t))),c:"6451f360-4-"+i+",6451f360-3",d:e.p({articleItem:t,isMe:!0,avatar:n.userInfo.avatar,username:n.userInfo.username}),e:t.id}))),x:e.p({label:"动态"}),y:e.p({index:"0",animation:!0,tabPadding:"80",flex:!0}),z:e.o(((...e)=>a.onScrolltolower&&a.onScrolltolower(...e))),A:n.editArticleItem.id},n.editArticleItem.id?{B:e.o((e=>a.onPopupReportClick(n.editArticleItem))),C:e.p({icon:"icon-alert",title:"举报"})}:{},{D:e.sr("articleActionPopup","6451f360-5"),E:e.p({needHead:!0,title:"动态选择",needCancelButton:!0})})}]]);n.__runtimeHooks=6,wx.createPage(a);
