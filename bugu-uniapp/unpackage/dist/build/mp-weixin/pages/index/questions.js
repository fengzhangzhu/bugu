"use strict";var e=require("../../common/vendor.js"),t=require("../../common/constants.js"),i=require("../../services/questionServices.js"),o=require("../../common/storageKeys.js"),s=require("../../utils/request.js");const n={emits:["onRefreshing"],props:{scollerHeight:{type:Number,require:!0},refresherEnabled:{type:Boolean,require:!0},myId:{type:Number,require:!0}},data:()=>({isLoading:!1,data:[],editQuestionItem:{}}),async created(){this.isLoading=!0},methods:{navigateTo(t){e.index.navigateTo({url:t})},onSearchBarClick(t="index"){e.index.navigateTo({url:"/pages/label-activity/search-question/search-question"})},onQuestionItemClick(t){e.index.navigateTo({url:`/pages/activity-info/question-info/question-info?questionId=${t}`})},onQuestionItemMoreClick(e){this.editQuestionItem=e,this.$refs.questionActionPopup.open()},async onQuestionFollow(t){if(await i.likeQuestion(t)){let i=this.data;for(let e=0;e<i.length;e++)if(i[e].issue.id==t){i[e].isLike=1,i[e].issue.likeSum=i[e].issue.likeSum+1;break}this.data=i,this.$refs.questionActionPopup.close(),e.index.showToast({title:"关注成功",icon:"success"})}else e.index.showToast({title:"关注失败",icon:"error"})},async onCancelQuestionFollow(t){if(await i.cancelLikeQuestion(t)){let i=this.data;for(let e=0;e<i.length;e++)if(i[e].issue.id==t){i[e].isLike=0,i[e].issue.likeSum=i[e].issue.likeSum-1;break}this.data=i,this.$refs.questionActionPopup.close(),e.index.showToast({title:"取消成功",icon:"success"})}else e.index.showToast({title:"取消失败",icon:"error"})},onQuestionReportClick(i){e.index.navigateTo({url:`/pages/setting/report-user/report-user?objectId=${i}&objectType=${t.reportObjectType.question}&modular=question`}),this.$refs.questionActionPopup.close()},onQuestionDeleteClick(t){let o=this;e.index.showModal({title:"删除问题",content:"你确定要删除这个问题吗",success:async function(s){if(s.confirm)if(await i.deleteQuestion(t)){let i=o.data;for(let e=0;e<i.length;e++)if(i[e].id==t){i.splice(e,1);break}o.data=i,o.$refs.questionActionPopup.close(),e.index.showToast({title:"删除成功",icon:"success"})}else e.index.showToast({title:"删除失败",icon:"error"})}})},getQuestions(e,i){s.request({data:{method:"GET",group:"question",action:"all",data:{page:e},header:{"content-type":"application/x-www-form-urlencoded"}}}).then((e=>{if(e.data.code===t.REQUEST_SUCCEEDED_CODE){let t=e.data.data.list;this.$refs.questionPaging.complete(t),this.isLoading=!1}else this.$refs.questionPaging.complete(!1),this.isLoading=!1}),(()=>{this.$refs.questionPaging.complete(!1),this.isLoading=!1}))},async playRefreshDynamicSound(){let i=e.index.getStorageSync(o.REFRESH_DYNAMIC_SOUND);i||(i=t.RingingToneList[6]);const s=e.index.createInnerAudioContext();s.autoplay=!0,s.src=i.url}}};if(!Array){(e.resolveComponent("question-item-skeleton")+e.resolveComponent("question-item")+e.resolveComponent("z-paging")+e.resolveComponent("action-sheet-item")+e.resolveComponent("action-sheet"))()}Math||((()=>"../../components/question-item-skeleton/question-item-skeleton.js")+(()=>"../../components/question-item/question-item.js")+(()=>"../../uni_modules/z-paging/components/z-paging/z-paging.js")+(()=>"../../components/action-sheet-item/action-sheet-item.js")+(()=>"../../components/action-sheet/action-sheet.js"))();var a=e._export_sfc(n,[["render",function(t,i,o,s,n,a){return e.e({a:e.o((e=>a.onSearchBarClick("question"))),b:e.o((e=>a.navigateTo("/pages/my-acticity/my-questions/my-questions"))),c:e.o((e=>a.navigateTo("/pages/my-acticity/my-answers/my-answers"))),d:e.o((e=>a.navigateTo("/pages/my-acticity/my-collected-question/my-collected-question"))),e:n.isLoading},n.isLoading?{f:e.f([...new Array(5)],((e,t,i)=>({a:"skeleton"+t,b:"296df0dd-1-"+i+",296df0dd-0"}))),g:e.p({needLabel:!1})}:{},{h:e.w((({item:t,index:i},o,s)=>({a:"question"+t.id,b:e.o((e=>a.onQuestionItemClick(t.id))),c:e.o((e=>a.onQuestionItemMoreClick(t))),d:"296df0dd-2-"+s+",296df0dd-0",e:e.p({questionData:t,answerData:t.hotAnswer}),f:s,g:o})),{name:"cell",path:"h",vueId:"296df0dd-0"}),i:e.sr("questionPaging","296df0dd-0"),j:e.o(a.getQuestions),k:e.p({"default-page-size":10,"use-virtual-list":!0,"cell-height-mode":"dynamic"}),l:n.editQuestionItem.id},n.editQuestionItem.id?e.e({m:n.editQuestionItem.publisher&&n.editQuestionItem.publisher.id==o.myId},n.editQuestionItem.publisher&&n.editQuestionItem.publisher.id==o.myId?{n:e.o((e=>a.onQuestionDeleteClick(n.editQuestionItem.id))),o:e.p({icon:"icon-delete",title:"删除"})}:e.e({p:e.o((e=>a.onQuestionReportClick(n.editQuestionItem.id))),q:e.p({icon:"icon-alert",title:"举报"}),r:n.editQuestionItem.isLiked},n.editQuestionItem.isLiked?{s:e.o((e=>a.onCancelQuestionFollow(n.editQuestionItem.id))),t:e.p({icon:"icon-quxiaoguanzhu",title:"取消关注"})}:{v:e.o((e=>a.onQuestionFollow(n.editQuestionItem.id))),w:e.p({icon:"icon-guanzhu",title:"关注问题"})})):{},{x:e.sr("questionActionPopup","296df0dd-3"),y:e.p({needHead:!0,title:"问题选择",needCancelButton:!0})})}]]);wx.createComponent(a);
