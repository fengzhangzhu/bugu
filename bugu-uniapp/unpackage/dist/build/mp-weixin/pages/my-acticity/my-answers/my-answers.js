"use strict";var e=require("../../../common/vendor.js"),t=require("../../../services/answerServices.js"),o=require("../../../common/storageFunctions.js"),n=require("../../../utils/request.js"),s=require("../../../common/constants.js");require("../../../common/storageKeys.js");const i={data:()=>({isLoading:!0,haveMoreData:!1,answers:[],showBottomLoading:!1,page:1,editAnswerItem:{},scrollInto:"",myUserInfo:{},myId:-1}),async onLoad(){let e=await o.getMyUserInfo();e&&(this.myId=e.id,this.myUserInfo=e),await this.getMyAnswer(this.page),this.isLoading=!1},methods:{onNarLeftClick(){e.index.navigateBack({delta:1})},onScrolltolower(){this.haveMoreData&&(this.page=this.page+1,this.getMyAnswer(this.page))},onQuestionItemClick(t){e.index.navigateTo({url:`/pages/activity-info/question-info/question-info?questionId=${t}`})},onQuestionItemMoreClick(e){this.editAnswerItem=e,this.$refs.answerActionPopup.open()},onAnswerDeleteClick(o){let n=this;e.index.showModal({title:"删除回答",content:"你确定要删除这个回答吗",success:async function(s){if(s.confirm)if(await t.deleteAnswer(o.id)){let t=n.answers;for(let e=0;e<t.length;e++)if(t[e].id==o.id){t.splice(e,1);break}n.answers=t,n.$refs.answerActionPopup.close(),e.index.showToast({title:"删除成功",icon:"success"})}else e.index.showToast({title:"删除失败",icon:"error"})}})},async getMyAnswer(t){let o=await n.request({data:{method:"GET",group:"answer",action:"my/publish",data:{page:t},header:{"content-type":"application/x-www-form-urlencoded"}}});if(o.data.code===s.REQUEST_SUCCEEDED_CODE){let e=o.data.data,n=e.list;if(n.length<1&&e.hasNext&&t<e.totalPages&&(this.page=t+1,this.getMyAnswer(this.page)),this.haveMoreData=e.hasNext,1===t)this.answers=n,this.scrollInto="";else{let e=this.answers.concat(n);this.answers=e}}e.index.hideLoading()}}};if(!Array){(e.resolveComponent("uni-nav-bar")+e.resolveComponent("question-item-skeleton")+e.resolveComponent("question-item")+e.resolveComponent("uni-load-more")+e.resolveComponent("action-sheet-item")+e.resolveComponent("action-sheet"))()}Math||((()=>"../../../uni_modules/uni-nav-bar/components/uni-nav-bar/uni-nav-bar.js")+(()=>"../../../components/question-item-skeleton/question-item-skeleton.js")+(()=>"../../../components/question-item/question-item.js")+(()=>"../../../uni_modules/uni-load-more/components/uni-load-more/uni-load-more.js")+(()=>"../../../components/action-sheet-item/action-sheet-item.js")+(()=>"../../../components/action-sheet/action-sheet.js"))();var a=e._export_sfc(i,[["render",function(t,o,n,s,i,a){return e.e({a:e.o((e=>a.onNarLeftClick())),b:e.p({"left-icon":"back",fixed:"true",backgroundColor:"#fff",color:"#808080",statusBar:"true"}),c:i.isLoading},i.isLoading?{d:e.f([...new Array(5)],((e,t,o)=>({a:"skeleton"+t,b:"0f5c8b34-1-"+o}))),e:e.p({needLabel:!1})}:e.e({f:e.f(i.answers,((t,o,n)=>({a:"question"+t.questionId,b:e.o((e=>a.onQuestionItemClick(t.questionId)),"question"+t.questionId),c:e.o((e=>a.onQuestionItemMoreClick(t)),"question"+t.questionId),d:"0f5c8b34-2-"+n,e:e.p({questionData:t.question,answerData:t})}))),g:i.answers.length<=0},i.answers.length<=0?{}:{h:e.p({status:i.haveMoreData?i.showBottomLoading?"loading":"more":"noMore",contentText:{contentdown:"上拉显示更多",contentrefresh:"正在加载...",contentnomore:"没有更多数据了"},iconType:"circle"})},{i:i.scrollInto,j:e.o(((...e)=>a.onScrolltolower&&a.onScrolltolower(...e)))}),{k:i.editAnswerItem.id},i.editAnswerItem.id?{l:e.o((e=>a.onAnswerDeleteClick(i.editAnswerItem))),m:e.p({icon:"icon-delete",title:"删除"})}:{},{n:e.sr("answerActionPopup","0f5c8b34-4"),o:e.p({needHead:!0,title:"回答选择",needCancelButton:!0})})}]]);wx.createPage(a);
