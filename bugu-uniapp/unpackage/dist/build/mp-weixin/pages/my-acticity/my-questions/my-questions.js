"use strict";var e=require("../../../common/vendor.js"),t=require("../../../services/questionServices.js"),o=require("../../../common/storageFunctions.js"),n=require("../../../utils/request.js"),i=require("../../../common/constants.js");require("../../../common/storageKeys.js");const s={data:()=>({isLoading:!0,haveMoreData:!1,questions:[],showBottomLoading:!1,page:1,editQuestionItem:{},scrollInto:"",myId:-1}),async onLoad(){let e=await o.getMyUserInfo();e&&(this.myId=e.id),await this.getMyQuestions(this.page),this.isLoading=!1},methods:{onNarLeftClick(){e.index.navigateBack({delta:1})},onScrolltolower(){this.haveMoreData&&(this.page=this.page+1,this.getMyQuestions(this.page))},onQuestionItemClick(t){e.index.navigateTo({url:`/pages/activity-info/question-info/question-info?questionId=${t}`})},onQuestionItemMoreClick(e){this.editQuestionItem=e,this.$refs.questionActionPopup.open()},onQuestionDeleteClick(o){let n=this;e.index.showModal({title:"删除问题",content:"你确定要删除这个问题吗",success:async function(i){if(i.confirm)if(await t.deleteQuestion(o)){let t=n.questions;for(let e=0;e<t.length;e++)if(t[e].issue.id==o){t.splice(e,1);break}n.questions=t,n.$refs.questionActionPopup.close(),e.index.showToast({title:"删除成功",icon:"success"})}else e.index.showToast({title:"删除失败",icon:"error"})}})},async getMyQuestions(t){let o=await n.request({data:{method:"GET",group:"question",action:"my/published",data:{page:t},header:{"content-type":"application/x-www-form-urlencoded"}}});if(o.data.code===i.REQUEST_SUCCEEDED_CODE){let e=o.data.data,n=e.list;if(n.length<1&&e.hasNext&&t<e.totalPages&&(this.page=t+1,this.getMyQuestions(this.page)),this.haveMoreData=e.hasNext,1===t)this.questions=n,this.scrollInto="";else{let e=this.questions.concat(n);this.questions=e}}e.index.hideLoading()}}};if(!Array){(e.resolveComponent("uni-nav-bar")+e.resolveComponent("question-item-skeleton")+e.resolveComponent("question-item")+e.resolveComponent("uni-load-more")+e.resolveComponent("action-sheet-item")+e.resolveComponent("action-sheet"))()}Math||((()=>"../../../uni_modules/uni-nav-bar/components/uni-nav-bar/uni-nav-bar.js")+(()=>"../../../components/question-item-skeleton/question-item-skeleton.js")+(()=>"../../../components/question-item/question-item.js")+(()=>"../../../uni_modules/uni-load-more/components/uni-load-more/uni-load-more.js")+(()=>"../../../components/action-sheet-item/action-sheet-item.js")+(()=>"../../../components/action-sheet/action-sheet.js"))();var a=e._export_sfc(s,[["render",function(t,o,n,i,s,a){return e.e({a:e.o((e=>a.onNarLeftClick())),b:e.p({"left-icon":"back",fixed:"true",backgroundColor:"#fff",color:"#808080",statusBar:"true"}),c:s.isLoading},s.isLoading?{d:e.f([...new Array(5)],((e,t,o)=>({a:"skeleton"+t,b:"94d4ce18-1-"+o}))),e:e.p({needLabel:!1})}:e.e({f:e.f(s.questions,((t,o,n)=>({a:"question"+t.id,b:e.o((e=>a.onQuestionItemClick(t.id)),"question"+t.id),c:e.o((e=>a.onQuestionItemMoreClick(t)),"question"+t.id),d:"94d4ce18-2-"+n,e:e.p({questionData:t,answerData:t.hotAnswer})}))),g:s.questions.length<=0},s.questions.length<=0?{}:{h:e.p({status:s.haveMoreData?s.showBottomLoading?"loading":"more":"noMore",contentText:{contentdown:"上拉显示更多",contentrefresh:"正在加载...",contentnomore:"没有更多数据了"},iconType:"circle"})},{i:s.scrollInto,j:e.o(((...e)=>a.onScrolltolower&&a.onScrolltolower(...e)))}),{k:s.editQuestionItem.id},s.editQuestionItem.id?{l:e.o((e=>a.onQuestionDeleteClick(s.editQuestionItem.id))),m:e.p({icon:"icon-delete",title:"删除"})}:{},{n:e.sr("questionActionPopup","94d4ce18-4"),o:e.p({needHead:!0,title:"问题选择",needCancelButton:!0})})}]]);wx.createPage(a);
