"use strict";var e=require("../../../common/vendor.js"),o=require("../../../utils/request.js"),n=require("../../../common/constants.js"),i=require("../../../common/storageFunctions.js"),t=require("../../../common/storageKeys.js");const s={data:()=>({username:"",password:"",agreest:!1,MainColor:n.MainColor}),methods:{onNarLeftClick(){e.index.navigateBack({delta:1})},onCheckBoxClick(){this.agreest=!this.agreest},onPasswordInput(e){this.password=e},onUsernameInput(e){this.username=e},onUserProtocolClick(){e.index.navigateTo({url:"/pages/login/bugu-use-protocol/bugu-use-protocol"})},onPrivacyPolicyClick(){e.index.navigateTo({url:"/pages/login/bugu-privacy-policy/bugu-privacy-policy"})},onLoginButtonClick(){this.username&&this.password?this.agreest?this.tryToLogin(this.username,this.password):e.index.showToast({title:"请先同意用户协议和隐私政策",icon:"none"}):e.index.showToast({title:"请先输入用户名或密码",icon:"none"})},async tryToLogin(s,r){e.index.showLoading({title:"正在登陆"});try{let a=await o.request({data:{method:"POST",group:"verify",action:"login",data:{username:s,password:r},header:{"content-type":"application/x-www-form-urlencoded"}}});if(e.index.hideLoading(),a.data.code===n.REQUEST_SUCCEEDED_CODE){e.index.showToast({title:"认证成功",icon:"success"});let o=await i.getMyUserInfo();o.isVerify=1,e.index.setStorage({key:t.USER_INFO,data:o}),setTimeout((function(){e.index.navigateBack({delta:1})}),1e3)}}catch{e.index.showToast({title:"登录失败，请稍后再试",icon:"none"})}}}};if(!Array){(e.resolveComponent("uni-nav-bar")+e.resolveComponent("uni-easyinput")+e.resolveComponent("uni-forms-item")+e.resolveComponent("uni-forms"))()}Math||((()=>"../../../uni_modules/uni-nav-bar/components/uni-nav-bar/uni-nav-bar.js")+(()=>"../../../uni_modules/uni-easyinput/components/uni-easyinput/uni-easyinput.js")+(()=>"../../../uni_modules/uni-forms/components/uni-forms-item/uni-forms-item.js")+(()=>"../../../uni_modules/uni-forms/components/uni-forms/uni-forms.js"))();var r=e._export_sfc(s,[["render",function(o,n,i,t,s,r){return{a:e.o((e=>r.onNarLeftClick())),b:e.p({"left-icon":"back",fixed:"true",backgroundColor:"#fff",color:"#808080",statusBar:"true"}),c:e.o(r.onUsernameInput),d:e.p({value:s.username,type:"text",placeholder:"请输入用户名"}),e:e.p({required:"true",label:"用户名",name:"username"}),f:e.o(r.onPasswordInput),g:e.p({value:s.password,type:"password",placeholder:"请输入密码"}),h:e.p({required:"true",label:"密码",name:"password"}),i:s.MainColor,j:e.o((e=>r.onCheckBoxClick())),k:s.agreest,l:e.o(((...e)=>r.onUserProtocolClick&&r.onUserProtocolClick(...e))),m:e.o(((...e)=>r.onPrivacyPolicyClick&&r.onPrivacyPolicyClick(...e))),n:s.MainColor,o:e.o((e=>r.onLoginButtonClick()))}}]]);wx.createPage(r);
