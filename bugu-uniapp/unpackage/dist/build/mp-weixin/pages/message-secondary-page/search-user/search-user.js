"use strict";var e=require("../../../common/vendor.js"),r=require("../../../common/storageKeys.js"),s=require("../../../utils/request.js"),t=require("../../../common/constants.js");const a={data:()=>({searchText:"",searchHistory:[],searchResult:[],showSeacrhHistory:!0}),async onLoad(){let s=await e.index.getStorageSync(r.SEARCH_USER_HISTORY);s&&(this.searchHistory=s)},methods:{onNarLeftClick(){e.index.navigateBack({delta:1})},onHistoryTextClick(e){this.searchText=e,this.searchUsers(this.searchText)},onSearchInput(e){this.searchText=e},onSearchConfirm(){this.searchText.length<1?e.index.showToast({title:"请先输入关键词"}):this.searchUsers(this.searchText)},async searchUsers(a){e.index.showLoading({title:"搜索中"});let o=await s.request({data:{method:"GET",group:"social",action:"searchUser",data:{username:a},header:{"content-type":"application/x-www-form-urlencoded"}}});if(e.index.hideLoading(),o.data.code===t.REQUEST_SUCCEEDED_CODE){let e=o.data.data;this.searchResult=e,this.showSeacrhHistory=!1}let n=e.index.getStorageSync(r.SEARCH_USER_HISTORY);n||(n=[]),-1==n.indexOf(a)?(n.push(a),n.length>10&&n.splice(0,1)):(n.splice(n.indexOf(a),1),n.push(a)),e.index.setStorage({key:r.SEARCH_USER_HISTORY,data:n}),this.searchHistory=n.reverse()}}};if(!Array){(e.resolveComponent("uni-nav-bar")+e.resolveComponent("uni-search-bar")+e.resolveComponent("search-user-item"))()}Math||((()=>"../../../uni_modules/uni-nav-bar/components/uni-nav-bar/uni-nav-bar.js")+(()=>"../../../uni_modules/uni-search-bar/components/uni-search-bar/uni-search-bar.js")+(()=>"../../../components/search-user-item/search-user-item.js"))();var o=e._export_sfc(a,[["render",function(r,s,t,a,o,n){return e.e({a:e.o((e=>n.onNarLeftClick())),b:e.p({"left-icon":"back",fixed:"true",backgroundColor:"#fff",color:"#808080",statusBar:"true"}),c:e.o(n.onSearchInput),d:e.o((e=>n.onSearchConfirm())),e:e.o((e=>o.searchText=e)),f:e.p({placeholder:"搜索用户",cancelButton:"none",modelValue:o.searchText}),g:e.o((e=>n.onSearchConfirm())),h:o.showSeacrhHistory},o.showSeacrhHistory?e.e({i:o.searchHistory.length>0},o.searchHistory.length>0?{j:e.f(o.searchHistory,((r,s,t)=>({a:e.t(r),b:r,c:e.o((e=>n.onHistoryTextClick(r)),r)})))}:{}):e.e({k:e.f(o.searchResult,((r,s,t)=>({a:r.id,b:"46d4ee62-2-"+t,c:e.p({item:r})}))),l:o.searchResult.length<=0},(o.searchResult.length,{})))}]]);wx.createPage(o);
